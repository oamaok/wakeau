<canvas class="login-background" id="login-background"></canvas>
<form class="login" method="post" action="login">
  <h1>wakeau</h1>
  <div class="field">
    <label for="username">username</label>
    <input id="username" name="username" type="test">
  </div>
  <div class="field">
    <label for="password">password</label>
    <input id="password" name="password" type="password">
  </div>
  <div class="field">
    <input type="submit" value="login">
  </div>
</form>
<script>
(function () {
var palette = {{palette}};

var width = 320;
var height = 180;
var speed = 0.003;
var lod = 0.0125;
var noiseLevel = 200;

var canvas = document.querySelector('#login-background');
console.log(canvas);
canvas.setAttribute('width', width + 'px');
canvas.setAttribute('height', height + 'px');
var context = canvas.getContext('2d');
context.fillRect(0,0,width,height);
var imageData = context.getImageData(0,0,width,height);
var t = Math.random() * 100;

function clamp(a, min, max) {
  return a < min ? min : a > max ? max : a ;
}

(function loop(){
  for(var x = 0; x < width; x++) {
    for(var y = 0; y < height; y++) {
      var index = (y * width + x) * 4;
      var cx = x * lod;
      var cy = y * lod;
      var v = 0;
      v += Math.sin(cx + t); + Math.sin((cy + t) * 0.5) + Math.sin((cx + cy * 2 + t) * 0.5);
      cx += Math.sin(t / 3)
      cy += Math.cos(t / 2);
      
      v -= Math.sin(Math.sqrt(cx * cx + cy * cy + 1) + t);
      var norm = Math.floor((Math.sin(v) * 0.5 + 0.5) * 254);
      var noise = -Math.random() * noiseLevel;
      imageData.data[index+0] = palette[norm][0];
      imageData.data[index+1] = palette[norm][1];
      imageData.data[index+2] = palette[norm][2];
    }
  }

  context.putImageData(imageData, 0, 0);
  t += speed;
  window.requestAnimationFrame(loop);
})();

})();

</script>